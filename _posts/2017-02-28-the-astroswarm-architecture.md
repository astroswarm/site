---
layout: post
title: "The AstroSwarm Architecture"
date: 2017-02-28 23:00:00 -0500
---

# Overview

AstroSwarm is a set of containers, running on Linux, on a Raspberry Pi. Its architecture looks like this:

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" version="1.1" viewBox="51 123 473 496" width="473pt" height="496pt"><metadata xmlns:dc="http://purl.org/dc/elements/1.1/"><dc:date>2017-03-01 03:23Z</dc:date><!-- Produced by OmniGraffle Professional 5.4.4 --></metadata><defs><filter id="Shadow" filterUnits="userSpaceOnUse"><feGaussianBlur in="SourceAlpha" result="blur" stdDeviation="3.488"/><feOffset in="blur" result="offset" dx="0" dy="4"/><feFlood flood-color="black" flood-opacity=".75" result="flood"/><feComposite in="flood" in2="offset" operator="in"/></filter><font-face font-family="Helvetica" font-size="12" units-per-em="1000" underline-position="-75.683594" underline-thickness="49.316406" slope="0" x-height="522.94922" cap-height="717.28516" ascent="770.01953" descent="-229.98047" font-weight="500"><font-face-src><font-face-name name="Helvetica"/></font-face-src></font-face></defs><g stroke="none" stroke-opacity="1" stroke-dasharray="none" fill="none" fill-opacity="1"><title>Today</title><g><title>Layer 1</title><g><use xl:href="#id1221_Graphic" filter="url(#Shadow)"/><use xl:href="#id1168_Graphic" filter="url(#Shadow)"/><use xl:href="#id1163_Graphic" filter="url(#Shadow)"/><use xl:href="#id1166_Graphic" filter="url(#Shadow)"/><use xl:href="#id1179_Graphic" filter="url(#Shadow)"/><use xl:href="#id1196_Graphic" filter="url(#Shadow)"/><use xl:href="#id1173_Graphic" filter="url(#Shadow)"/><use xl:href="#id1189_Graphic" filter="url(#Shadow)"/><use xl:href="#id1181_Graphic" filter="url(#Shadow)"/><use xl:href="#id1200_Graphic" filter="url(#Shadow)"/><use xl:href="#id1175_Graphic" filter="url(#Shadow)"/><use xl:href="#id1177_Graphic" filter="url(#Shadow)"/><use xl:href="#id1197_Graphic" filter="url(#Shadow)"/><use xl:href="#id1201_Graphic" filter="url(#Shadow)"/></g><line x1="313.06472" y1="348.34874" x2="352.93528" y2="384.67525" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="262.93528" y1="348.34874" x2="223.06471" y2="384.67525" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="287.99999" y1="512.512" x2="287.99999" y2="548.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="288.00001" y1="430.512" x2="288.00001" y2="466.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="107.99999" y1="430.512" x2="107.99999" y2="466.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="468" y1="430.512" x2="468" y2="466.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="324.455" y1="342.11928" x2="431.545" y2="390.9047" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="287.99999" y1="348.512" x2="287.99999" y2="384.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="251.54499" y1="342.11928" x2="144.45501" y2="390.9047" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="287.99999" y1="266.512" x2="287.99999" y2="302.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><line x1="287.99999" y1="184.51199" x2="287.99999" y2="220.51199" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id1221_Graphic"><rect x="252" y="139.01199" width="72" height="45" fill="white"/><rect x="252" y="139.01199" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 147.51199)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="3.3173828" y="11" textLength="58.69922">Telescope </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.9902344" y="25" textLength="52.01953">Hardware</tspan></text></g><g id="id1168_Graphic"><rect x="252" y="221.01199" width="72" height="45" fill="white"/><rect x="252" y="221.01199" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 229.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="13.325195" y="11" textLength="38.683594">Mobile </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.65625" y="25" textLength="52.6875">Computer</tspan></text></g><g id="id1163_Graphic"><rect x="252" y="303.012" width="72" height="45" fill="white"/><rect x="252" y="303.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 318.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="16.65625" y="11" textLength="28.6875">Linux</tspan></text></g><g id="id1166_Graphic"><rect x="72" y="385.012" width="72" height="45" fill="white"/><rect x="72" y="385.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(77 393.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.984375" y="11" textLength="55.365234">Container </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.6474609" y="25" textLength="58.705078">Application</tspan></text></g><g id="id1179_Graphic"><rect x="72" y="467.012" width="72" height="45" fill="white"/><rect x="72" y="467.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(77 482.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="18.332031" y="11" textLength="25.335938">VNC</tspan></text></g><g id="id1196_Graphic"><rect x="162" y="385.012" width="72" height="45" fill="white"/><rect x="162" y="385.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(167 393.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.984375" y="11" textLength="55.365234">Container </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.6474609" y="25" textLength="58.705078">Application</tspan></text></g><g id="id1173_Graphic"><rect x="252" y="385.012" width="72" height="45" fill="white"/><rect x="252" y="385.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 393.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.984375" y="11" textLength="55.365234">Container </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.6474609" y="25" textLength="58.705078">Application</tspan></text></g><g id="id1189_Graphic"><rect x="252" y="549.012" width="72" height="45" fill="white"/><rect x="252" y="549.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 564.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="8.6640625" y="11" textLength="44.671875">User I/O</tspan></text></g><g id="id1181_Graphic"><rect x="252" y="467.012" width="72" height="45" fill="white"/><rect x="252" y="467.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(257 475.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="18.663086" y="11" textLength="28.007812">Web </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.6474609" y="25" textLength="58.705078">Application</tspan></text></g><g id="id1200_Graphic"><rect x="342" y="385.012" width="72" height="45" fill="white"/><rect x="342" y="385.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(347 393.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.984375" y="11" textLength="55.365234">Container </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.6474609" y="25" textLength="58.705078">Application</tspan></text></g><g id="id1175_Graphic"><rect x="432" y="385.012" width="72" height="45" fill="white"/><rect x="432" y="385.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(437 393.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="4.984375" y="11" textLength="55.365234">Container </tspan><tspan font-family="Helvetica" font-size="12" font-weight="500" x="1.6474609" y="25" textLength="58.705078">Application</tspan></text></g><g id="id1177_Graphic"><rect x="432" y="467.012" width="72" height="45" fill="white"/><rect x="432" y="467.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(437 482.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="18.332031" y="11" textLength="25.335938">VNC</tspan></text></g><line x1="197.99999" y1="430.512" x2="197.99999" y2="466.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id1197_Graphic"><rect x="162" y="467.012" width="72" height="45" fill="white"/><rect x="162" y="467.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(167 482.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="18.332031" y="11" textLength="25.335938">VNC</tspan></text></g><line x1="378.00001" y1="430.512" x2="378.00001" y2="466.512" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><g id="id1201_Graphic"><rect x="342" y="467.012" width="72" height="45" fill="white"/><rect x="342" y="467.012" width="72" height="45" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/><text transform="translate(347 482.512)" fill="black"><tspan font-family="Helvetica" font-size="12" font-weight="500" x="18.332031" y="11" textLength="25.335938">VNC</tspan></text></g></g></g></svg>

Below are brief explanations for our major design decisions.

## Mobile Computer

A mobile computer has smaller physical size and lower power requirements than a laptop or desktop computer. This makes AstroSwarm especially portable and easy to use in the field.
 
We target a single mobile architecture rather than mobile hardware at large. This greatly reduces the number of system configurations we must support, as we have only one Linux flavor and one set of hardware for everything beneath the USB bus. This is especially important given [how fragmented](/2017/02/26/the-astroswarm-platform.html) the astronomy hardware landscape is.

## Containerization

Every application runs inside its own container. This provides several benefits:

1. We can add any application to our pipeline without worrying about file system or port collisions with other applications.
1. Most application security flaws will compromise only the affected application and not the entire system. 
1. The platform is easier to debug because each application is isolated; the artifacts of one application won't affect the state of another.
1. We can allocate and prioritize resources at an application level rather than having to do it at a process level.
1. All applications may be upgraded independently of the larger system, simply by downloading the latest container image for that application.

## Web Application

All user input is performed through a web site.

To start, VNC interfaces for each application are provided on the web site. Once those applications can be controlled programmatically, we'll replace the VNC interfaces with native web interfaces.

The web site itself runs in a container, and enjoys all of the aforementioned benefits of containerization.

# Technologies Used

* [Docker](https://www.docker.com) is used for containerization.
* The mobile computer is a [Raspberry Pi 3 Model B](https://www.raspberrypi.org/products/raspberry-pi-3-model-b).
* [Raspbian](https://www.raspbian.org) is our chosen flavor of Linux.
* Our web frontend is written in [Elm](http://elm-lang.org).
* I wrote [phd2ctrl](https://github.com/astroswarm/phd2ctrl) in [Elixir](http://elixir-lang.org). phd2ctrl is a command line interface for PHD2. It will allow us to control most functions of PHD2 programmatically rather than through a GUI.

# See for Yourself

As of today, [AstroSwarm](https://github.com/astroswarm) is free, open source software. The only repo you need to get started is [swarm_builder](https://github.com/astroswarm/swarm_builder), though if you're connecting over a wifi network, [swarm_pi_flasher](https://github.com/astroswarm/swarm_pi_flasher) will make your life a lot easier.

READMEs are included in both repositories, but my next post will include a full walkthrough for getting started.